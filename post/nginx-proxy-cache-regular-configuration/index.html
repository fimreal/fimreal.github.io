<!doctype html><html lang=zh-cn>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge,chrome=1">
<title>nginx location è§„åˆ™ä½¿ç”¨æ­£åˆ™æ—¶æ”¹å†™ request_uri æŠ¥é”™ - é—²éš…</title>
<meta name=renderer content="webkit">
<meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1">
<meta http-equiv=cache-control content="no-transform">
<meta http-equiv=cache-control content="no-siteapp">
<meta name=theme-color content="#f8f5ec">
<meta name=msapplication-navbutton-color content="#f8f5ec">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec">
<meta name=author content="Fimreal"><meta name=description content="åœ¨ nginx ä¸­ä½¿ç”¨æ­£åˆ™åŒ¹é…ï¼ŒåŒæ—¶æ”¹å†™ proxy_pass $request_uri çš„å°æŠ€å·§ï¼Œè®°ä½å­¦ä¼šäº†ï¼Œåšå„ç§å„æ ·çš„ç¼“å­˜è§„åˆ™åŒ¹é…éƒ½ä¸æ€•ã€‚"><meta name=keywords content="nginx">
<meta name=generator content="Hugo 0.88.1 with theme even">
<link rel=canonical href=blog.epurs.com/post/nginx-proxy-cache-regular-configuration/>
<link rel=apple-touch-icon sizes=180x180 href=/blog.epurs.com/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/blog.epurs.com/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/blog.epurs.com/favicon-16x16.png>
<link rel=manifest href=/blog.epurs.com/manifest.json>
<link rel=mask-icon href=/blog.epurs.com/safari-pinned-tab.svg color=#5bbad5>
<link href=/blog.epurs.com/sass/main.min.520181dd342d9369197dd9e27d41b8f7108626419bf37348947efbbba4d9724c.css rel=stylesheet>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous>
<meta property="og:title" content="nginx location è§„åˆ™ä½¿ç”¨æ­£åˆ™æ—¶æ”¹å†™ request_uri æŠ¥é”™">
<meta property="og:description" content="åœ¨ nginx ä¸­ä½¿ç”¨æ­£åˆ™åŒ¹é…ï¼ŒåŒæ—¶æ”¹å†™ proxy_pass $request_uri çš„å°æŠ€å·§ï¼Œè®°ä½å­¦ä¼šäº†ï¼Œåšå„ç§å„æ ·çš„ç¼“å­˜è§„åˆ™åŒ¹é…éƒ½ä¸æ€•ã€‚">
<meta property="og:type" content="article">
<meta property="og:url" content="blog.epurs.com/post/nginx-proxy-cache-regular-configuration/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2019-05-09T06:51:22+00:00">
<meta property="article:modified_time" content="2019-08-19T14:35:05+08:00">
<meta itemprop=name content="nginx location è§„åˆ™ä½¿ç”¨æ­£åˆ™æ—¶æ”¹å†™ request_uri æŠ¥é”™">
<meta itemprop=description content="åœ¨ nginx ä¸­ä½¿ç”¨æ­£åˆ™åŒ¹é…ï¼ŒåŒæ—¶æ”¹å†™ proxy_pass $request_uri çš„å°æŠ€å·§ï¼Œè®°ä½å­¦ä¼šäº†ï¼Œåšå„ç§å„æ ·çš„ç¼“å­˜è§„åˆ™åŒ¹é…éƒ½ä¸æ€•ã€‚"><meta itemprop=datePublished content="2019-05-09T06:51:22+00:00">
<meta itemprop=dateModified content="2019-08-19T14:35:05+08:00">
<meta itemprop=wordCount content="1271">
<meta itemprop=keywords content="nginx,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="nginx location è§„åˆ™ä½¿ç”¨æ­£åˆ™æ—¶æ”¹å†™ request_uri æŠ¥é”™">
<meta name=twitter:description content="åœ¨ nginx ä¸­ä½¿ç”¨æ­£åˆ™åŒ¹é…ï¼ŒåŒæ—¶æ”¹å†™ proxy_pass $request_uri çš„å°æŠ€å·§ï¼Œè®°ä½å­¦ä¼šäº†ï¼Œåšå„ç§å„æ ·çš„ç¼“å­˜è§„åˆ™åŒ¹é…éƒ½ä¸æ€•ã€‚"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]-->
</head>
<body>
<div id=mobile-navbar class=mobile-navbar>
<div class=mobile-header-logo>
<a href=/blog.epurs.com/ class=logo>é—²éš…</a>
</div>
<div class=mobile-navbar-icon>
<span></span>
<span></span>
<span></span>
</div>
</div>
<nav id=mobile-menu class="mobile-menu slideout-menu">
<ul class=mobile-menu-list>
<a href=blog.epurs.com/>
<li class=mobile-menu-item>ä¸»é¡µ</li>
</a><a href=blog.epurs.com/post/>
<li class=mobile-menu-item>å½’æ¡£</li>
</a><a href=blog.epurs.com/tags/>
<li class=mobile-menu-item>æ ‡ç­¾</li>
</a><a href=blog.epurs.com/categories/>
<li class=mobile-menu-item>åˆ†ç±»</li>
</a>
</ul>
</nav>
<div class=container id=mobile-panel>
<header id=header class=header>
<div class=logo-wrapper>
<a href=/blog.epurs.com/ class=logo>é—²éš…</a>
</div>
<nav class=site-navbar>
<ul id=menu class=menu>
<li class=menu-item>
<a class=menu-item-link href=blog.epurs.com/>ä¸»é¡µ</a>
</li><li class=menu-item>
<a class=menu-item-link href=blog.epurs.com/post/>å½’æ¡£</a>
</li><li class=menu-item>
<a class=menu-item-link href=blog.epurs.com/tags/>æ ‡ç­¾</a>
</li><li class=menu-item>
<a class=menu-item-link href=blog.epurs.com/categories/>åˆ†ç±»</a>
</li>
</ul>
</nav>
</header>
<main id=main class=main>
<div class=content-wrapper>
<div id=content class=content>
<article class=post>
<header class=post-header>
<h1 class=post-title>nginx location è§„åˆ™ä½¿ç”¨æ­£åˆ™æ—¶æ”¹å†™ request_uri æŠ¥é”™</h1>
<div class=post-meta>
<span class=post-time> 2019-05-09 </span>
<div class=post-category>
<a href=/blog.epurs.com/categories/web/> web </a>
</div>
<span class=more-meta> çº¦ 1271 å­— </span>
<span class=more-meta> é¢„è®¡é˜…è¯» 3 åˆ†é’Ÿ </span>
</div>
</header>
<div class=post-toc id=post-toc>
<h2 class=post-toc-title>æ–‡ç« ç›®å½•</h2>
<div class=post-toc-content>
<nav id=TableOfContents>
<ul>
<li>
<ul>
<li></li>
</ul>
</li>
</ul>
</nav>
</div>
</div>
<div class=post-content>
<p>ä»Šå¤©åœ¨é…ç½® nginx ç¼“å­˜æ—¶ï¼Œé‡åˆ°ä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜ï¼Œå¼€å‘åé¦ˆéœ€è¦å®ç°ç¼“å­˜ç‰¹å®šè·¯å¾„ä¸‹çš„æ•°æ®ï¼Œå¹¶ä¸”è¦èƒ½æ‰‹åŠ¨æ¸…é™¤ç¼“å­˜ã€‚ç¼“å­˜é…ç½®å’Œæ¸…é™¤çš„åŠæ³•åœ¨å‰é¢å·²ç»æœ‰ä»‹ç»ï¼Œä½†æ˜¯ç»™å‡ºçš„è·¯å¾„ä¸­é—´æœ‰ä¸€ä½ä¼šå˜åŠ¨ï¼Œä¹Ÿå°±æ˜¯è¯´éœ€è¦ location æ­£åˆ™åŒ¹é…åŒºåˆ†ã€‚
â€œä¼—æ‰€å‘¨çŸ¥â€ï¼Œlocation åŒºå—åŒ¹é…æ­£åˆ™è¡¨è¾¾å¼æ—¶ï¼Œå†…éƒ¨ proxy_pass å¦‚æœç»§ç»­é…ç½®ä½¿ç”¨ request_uri æ”¹å†™åŠŸèƒ½ï¼ˆå³ http://somewhere/path å½¢å¼ï¼‰ä¼šæŠ¥é”™ä¸å¯ç”¨ï¼Œé‚£è¦æ€ä¹ˆè§£å†³è¿™ä¸ªéœ€æ±‚å‘¢ï¼Ÿäº‹å®æƒ…å†µå¹¶æ²¡æœ‰è¿™ä¹ˆç®€å•ã€‚</p>
<p>æµ‹è¯•ä½¿ç”¨ç¯å¢ƒä¸º nginx-1.15.8 ï¼Œè¿‘å‡ å¹´çš„ç‰ˆæœ¬åº”è¯¥éƒ½ä¸€è‡´ã€‚</p>
<h4 id=å¼€å‘çš„éœ€æ±‚>å¼€å‘çš„éœ€æ±‚</h4>
<p>æœ‰ uri ï¼š</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>https://domain/api/v2/app/.../24/data
</code></pre></td></tr></table>
</div>
</div><p>éœ€è¦è½¬åˆ°åç«¯æœåŠ¡å™¨ä¸ºï¼š</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback>http://domain/app/.../24/data
</code></pre></td></tr></table>
</div>
</div><p>å…¶ä¸­åªéœ€è¦ç¼“å­˜ <code>.../24/data</code> å†…å®¹ï¼Œä½†æ˜¯ä¸èƒ½å¯¹ <code>.../24</code>ã€<code>.../24/something</code> åšç¼“å­˜ï¼Œæ•°å­—ä½ â€œ24â€ ä¼šéšç€æŸ¥è¯¢æ•°æ®ä¸åŒå˜åŒ–ã€‚</p>
<p>é‚£ä¹ˆæ¡ä»¶é™å®šæ­»äº†ï¼š</p>
<ol>
<li>ä¸å¯èƒ½é€šè¿‡æ•°å­—å‰é¢å†…å®¹æ¥åŒ¹é…ç¼“å­˜ path</li>
<li>è¦åŒ¹é…å¯å˜æ•°å­—ï¼Œå¹¶ä¸”æ•°å­—åé¢æ˜¯å›ºå®š <code>/data</code></li>
<li><code>proxy_pass</code>éœ€è¦æ”¹å†™ path ï¼Œrewrite ä¸ç¬¦åˆéœ€æ±‚ã€‚</li>
</ol>
<h4 id=å¤±è´¥çš„å°è¯•>å¤±è´¥çš„å°è¯•</h4>
<p>å¯èƒ½æ˜¯ä¹‹å‰çš„çŸ¥è¯†å›ºåŒ–äº†æ€ç»´ï¼Œæˆ‘ä»¥ä¸ºåœ¨ <code>location</code> åå†™æ­£åˆ™ï¼Œå†å»æ”¹å†™ path ï¼Œä¸”ä¸è¯´æ€ä¹ˆæŠŠæŠŠå˜åŒ–çš„æ•°å­—ä¼ é€’ç»™ <code>upstream_addr</code>ï¼Œnginx ä¸æ˜¯ä¸å…è®¸è¿™æ ·åšï¼Œä¼šç›´æ¥ç»™å‡ºæŠ¥é”™å—ï¼Ÿ</p>
<p>é‚£ä¹ˆå¦‚æœä½¿ç”¨ <code>if</code> æ¥é™å®šç¼“å­˜çš„ path æ˜¯ä¸æ˜¯å°±å¯ä»¥äº†ï¼Œé—æ†¾çš„æ˜¯ nginx ä¹Ÿä¼šæŠ¥é”™ã€‚æŸ¥é˜… <a href=https://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_cache>nginx.org</a> æ–‡æ¡£è¯´æ˜å¯ä»¥å‘ç°ï¼Œproxy_cache ä¸èƒ½ç”¨åœ¨ <code>if</code> è¯­å¥å†…ã€‚</p>
<h4 id=æ­£ç¡®çš„ç”¨æ³•>æ­£ç¡®çš„ç”¨æ³•</h4>
<p>ä¸ºä»€ä¹ˆ <code>rewrite</code> è§„åˆ™å¯ä»¥ä½¿ç”¨ æ­£åˆ™ï¼Œè€Œä¸”ç”¨çš„å¾ˆå¥½ï¼Œnginx å´ä¸ç»™ location æ·»åŠ æ”¯æŒå‘¢ï¼Ÿè¿™æ—¶å€™çµå…‰ä¸€é—ªæƒ³åˆ°å¯ä¸å¯ä»¥ç”¨ <code>$1</code> å˜é‡æ¥ä»£æ›¿å¯å˜çš„æ•°å­—ï¼Œè¯•äº†å†è¯´ &mldr;</p>
<p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx>  <span class=k>...</span>
<span class=s>location</span> <span class=p>~</span> <span class=sr>/api/v2/app/.../([0-9]+)/data</span> <span class=p>{</span>
  	<span class=kn>proxy_redirect</span> <span class=no>off</span><span class=p>;</span>
    <span class=kn>proxy_set_header</span>         <span class=s>Host</span> <span class=nv>$host</span><span class=p>;</span>
    <span class=kn>proxy_set_header</span>         <span class=s>X-real-ip</span> <span class=nv>$remote_addr</span><span class=p>;</span>
    <span class=kn>proxy_set_header</span>         <span class=s>X-Forwarded-For</span> <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
    <span class=kn>proxy_pass</span>               <span class=s>http://domain/app/.../</span><span class=nv>$1/data</span><span class=p>;</span>

    <span class=kn>proxy_buffering</span>          <span class=no>on</span><span class=p>;</span><span class=c1># é¿å…å…¨å±€é…ç½®å…³é—­ä»£ç†ç¼“å­˜
</span><span class=c1></span>    <span class=kn>proxy_cache</span>              <span class=s>cache_zone1</span><span class=p>;</span>   <span class=c1># å®šä¹‰çš„ cache_zone åç§°
</span><span class=c1></span>    <span class=kn>proxy_cache_key</span>          <span class=s>&#34;</span><span class=nv>$host$request_uri&#34;</span><span class=p>;</span>   <span class=c1># å®šä¹‰ç¼“å­˜å­˜æ”¾ç›®å½•çš„å­ç›®å½•å‘½åè§„åˆ™
</span><span class=c1></span>    <span class=kn>add_header</span> <span class=s>Cache</span>         <span class=s>&#34;</span><span class=nv>$upstream_cache_status&#34;</span><span class=p>;</span> <span class=c1># å¢åŠ ç¼“å­˜å¤´ä¿¡æ¯ï¼Œä¾¿äºåˆ¤æ–­æ˜¯å¦å‘½ä¸­
</span><span class=c1></span>    <span class=kn>proxy_cache_valid</span>        <span class=mi>200</span> <span class=mi>304</span> <span class=mi>301</span> <span class=mi>302</span> <span class=s>2h</span><span class=p>;</span>
    <span class=kn>proxy_cache_valid</span>        <span class=mi>404</span> <span class=mi>1m</span><span class=p>;</span>
    <span class=kn>proxy_cache_valid</span>        <span class=s>any</span> <span class=mi>5m</span><span class=p>;</span>
<span class=p>}</span>
  <span class=k>...</span>
</code></pre></td></tr></table>
</div>
</div><p>nginx reload !ï¼</p>
<p>ç»“æœç«Ÿç„¶æ²¡æœ‰æŠ¥é”™ï¼Œç®€å•æ·»åŠ ä¸€ä¸ªå˜é‡çš„ï¼Œå°±å®ç°äº†åŸæ¥è§‰ç€ä¸å¯èƒ½å®ç°çš„éœ€æ±‚ã€‚</p>
<h4 id=åç»­æµ‹è¯•>åç»­æµ‹è¯•</h4>
<p>æµ‹è¯•ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œåé¢æ”¹å†™è·¯å¾„ä¸º â€œ/â€</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=c1># cat test.conf
</span><span class=c1></span><span class=k>server</span> <span class=p>{</span>
    <span class=kn>location</span> <span class=p>~</span> <span class=sr>/.*</span>  <span class=p>{</span>
        <span class=kn>proxy_pass</span> <span class=s>http://epurs.com/</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>}</span>
<span class=c1># nginx -t
</span><span class=c1></span><span class=k>2019/05/09</span> <span class=n>17</span><span class=p>:</span><span class=mi>13</span><span class=p>:</span><span class=mi>30</span> <span class=s>[emerg]</span> <span class=mi>7685</span><span class=c1>#7685: &#34;proxy_pass&#34; cannot have URI part in location given by regular expression, or inside named location, or inside &#34;if&#34; statement, or inside &#34;limit_except&#34; block in /etc/nginx/conf.d/test.conf:3
</span><span class=c1></span><span class=s>nginx:</span> <span class=s>[emerg]</span> <span class=s>&#34;proxy_pass&#34;</span> <span class=s>cannot</span> <span class=s>have</span> <span class=s>URI</span> <span class=s>part</span> <span class=s>in</span> <span class=s>location</span> <span class=s>given</span> <span class=s>by</span> <span class=s>regular</span> <span class=s>expression,</span> <span class=s>or</span> <span class=s>inside</span> <span class=s>named</span> <span class=s>location,</span> <span class=s>or</span> <span class=s>inside</span> <span class=s>&#34;if&#34;</span> <span class=s>statement,</span> <span class=s>or</span> <span class=s>inside</span> <span class=s>&#34;limit_except&#34;</span> <span class=s>block</span> <span class=s>in</span> <span class=s>/etc/nginx/conf.d/test.conf:3</span>
<span class=s>nginx:</span> <span class=s>configuration</span> <span class=s>file</span> <span class=s>/etc/nginx/nginx.conf</span> <span class=s>test</span> <span class=s>failed</span>
</code></pre></td></tr></table>
</div>
</div><p>æŠ¥é”™ã€‚</p>
<p>æµ‹è¯•ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ï¼Œä½¿ç”¨å˜é‡åŒ¹é… <code>request_uri</code>ï¼Œåé¢æ”¹å†™è·¯å¾„ä¸º â€œ/$1â€</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=c1># cat test.conf
</span><span class=c1></span><span class=k>server</span> <span class=p>{</span>
    <span class=kn>location</span> <span class=p>~</span> <span class=sr>/(.*)</span>  <span class=p>{</span>
        <span class=kn>proxy_pass</span> <span class=s>http://epurs.com/</span><span class=nv>$1</span><span class=p>;</span>
    <span class=p>}</span>
<span class=p>}</span>
<span class=c1># nginx -t
</span><span class=c1></span><span class=k>nginx:</span> <span class=s>the</span> <span class=s>configuration</span> <span class=s>file</span> <span class=s>/etc/nginx/nginx.conf</span> <span class=s>syntax</span> <span class=s>is</span> <span class=s>ok</span>
<span class=s>nginx:</span> <span class=s>configuration</span> <span class=s>file</span> <span class=s>/etc/nginx/nginx.conf</span> <span class=s>test</span> <span class=s>is</span> <span class=s>successful</span>
</code></pre></td></tr></table>
</div>
</div><p>å¯ç”¨ã€‚</p>
<p>åç»­å¤šæ¬¡æµ‹è¯•åå‘ç°ï¼Œå½“ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…æ—¶ï¼Œä½¿ç”¨ä¸å­˜åœ¨çš„å˜é‡ <code>$dontexist</code>ä½œä¸ºæ”¹å†™è·¯å¾„ï¼š</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-nginx data-lang=nginx><span class=c1># nginx -t
</span><span class=c1></span><span class=k>2019/05/09</span> <span class=n>17</span><span class=p>:</span><span class=mi>31</span><span class=p>:</span><span class=mi>09</span> <span class=s>[emerg]</span> <span class=mi>7787</span><span class=c1>#7787: unknown &#34;dontexist&#34; variable
</span><span class=c1></span><span class=s>nginx:</span> <span class=s>[emerg]</span> <span class=s>unknown</span> <span class=s>&#34;dontexist&#34;</span> <span class=s>variable</span>
<span class=s>nginx:</span> <span class=s>configuration</span> <span class=s>file</span> <span class=s>/etc/nginx/nginx.conf</span> <span class=s>test</span> <span class=s>failed</span>
</code></pre></td></tr></table>
</div>
</div><p>æŠ¥é”™ã€‚</p>
<p>ä½†æ˜¯å¦‚æœå˜é‡æ˜¯æ•°å­—è¡¨ç¤ºï¼Œå³ä¸€ä¸ªç©ºå˜é‡ï¼Œæµ‹è¯•æ˜¯å¯ä»¥é€šè¿‡çš„ã€‚</p>
<h4 id=ç»“è®º>ç»“è®º</h4>
<p>å¯è§ï¼Œnginx ä¹Ÿä¸æ˜¯ä¸èƒ½ç”¨æ­£åˆ™æ¥åŒ¹é…è§„åˆ™ï¼Œç½‘ä¸Šç»å¸¸æåˆ° <code>location</code> ç”¨æ³•ä¸­è¯´åˆ°çš„ æ­£åˆ™åŒ¹é…æ—¶ï¼Œåé¢ä¸èƒ½å†ç”¨ â€œhttp://domain/pathâ€ å…¶å®æ˜¯é”™è¯¯çš„è¯´æ³•ã€‚</p>
<p>çœŸå®æƒ…å†µæ˜¯ï¼Œå¦‚æœå‰é¢ä½¿ç”¨äº†æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å‡ºç°å¤šç§å¯èƒ½è·¯å¾„ï¼Œé‚£ä¹ˆåé¢ä¹Ÿéœ€è¦ä¸€ä¸ªå¯¹åº”çš„å˜é‡æ¥ä¿è¯è·¯å¾„ä¹Ÿæ˜¯å¯å˜çš„ã€‚è¿™ä¸ªå˜é‡åªè¦çœŸå®å­˜åœ¨å“ªæ€•ä¸ºç©ºï¼Œåªè¦ä¸æ˜¯ä¸å­˜åœ¨çš„å˜é‡ï¼Œå°±å¯ä»¥é€šè¿‡é€šè¿‡ <code>nginx -t</code> æ£€æŸ¥ã€‚</p>
<p>å¸¸ç”¨çš„æ¯”å¦‚ <code>$1</code>ã€<code>request_uri</code> ä½¿ç”¨èµ·æ¥å¯ä»¥æ­é…æ­£åˆ™è¡¨è¾¾å¼å®ç°çµæ´»è½¬å‘ã€‚
å½“ç„¶è¦æ³¨æ„ä½¿ç”¨æ­£åˆ™æ—¶ï¼Œä¼˜å…ˆçº§å¹¶ä¸é«˜çš„é—®é¢˜ã€‚</p>
</div>
<footer class=post-footer>
<div class=post-tags>
<a href=/blog.epurs.com/tags/nginx/>nginx</a>
</div>
<nav class=post-nav>
<a class=prev href=blog.epurs.com/post/google-authenticator/>
<i class="iconfont icon-left"></i>
<span class="prev-text nav-default">ä½¿ç”¨ google_authenticator ç”ŸæˆåŠ¨æ€å¯†ç åŠ å›º ssh ç™»é™†</span>
<span class="prev-text nav-mobile">ä¸Šä¸€ç¯‡</span>
</a>
<a class=next href=blog.epurs.com/post/nginx-proxy-cache-configuration/>
<span class="next-text nav-default">nginx é…ç½® proxy_cache ç¼“å­˜åŠŸèƒ½ï¼Œé™„å¸¦æ¸…ç†ç¼“å­˜è„šæœ¬</span>
<span class="next-text nav-mobile">ä¸‹ä¸€ç¯‡</span>
<i class="iconfont icon-right"></i>
</a>
</nav>
</footer>
</article>
</div>
<div id=vcomments></div>
<script src=//cdn1.lncld.net/static/js/3.0.4/av-min.js></script>
<script src=//unpkg.com/valine/dist/Valine.min.js></script>
<script type=text/javascript>new Valine({el:'#vcomments',appId:'GbB0g7iuHvLyDClFmsBwewUS-gzGzoHsz',appKey:'cq9Rl1lkMWGfkEoq93b6t3bJ',notify:!1,verify:!0,avatar:'mp',placeholder:'Say something...',visitor:!1})</script>
</div>
</main>
<footer id=footer class=footer>
<div class=social-links>
<a href=mailto:&amp;#108;&amp;#109;&amp;#114;&amp;#64;&amp;#101;&amp;#112;&amp;#117;&amp;#114;&amp;#115;&amp;#46;&amp;#99;&amp;#111;&amp;#109; class="iconfont icon-email" title=email></a>
<a href=blog.epurs.com/index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a>
</div>
<div class=copyright>
<span class=power-by>
ç”± <a class=hexo-link href=https://gohugo.io>Hugo</a> å¼ºåŠ›é©±åŠ¨
</span>
<span class=division>|</span>
<span class=theme-info>
ä¸»é¢˜ -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a>
</span>
<span class=copyright-year>
&copy;
2018 -
2021<span class=heart><i class="iconfont icon-heart"></i></span><span>Fimreal</span>
<a class=theme-link href=http://beian.miit.gov.cn>äº¬ICPå¤‡18059304å·-1</a>
<a href=https://webify.cloudbase.net/> ğŸš€ Powered by CloudBase Webify</a>
</span>
</div>
</footer>
<div class=back-to-top id=back-to-top>
<i class="iconfont icon-up"></i>
</div>
</div>
<script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script>
<script type=text/javascript src=/blog.epurs.com/js/main.min.c99b103c33d1539acf3025e1913697534542c4a5aa5af0ccc20475ed2863603b.js></script>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-138489412-1','auto'),ga('set','anonymizeIp',!0),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</body>
</html>